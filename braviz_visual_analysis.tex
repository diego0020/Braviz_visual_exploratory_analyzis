\RequirePackage{fix-cm}

\documentclass{frontiersHLTH}
\usepackage{url,hyperref,lineno,microtype,subcaption}
\usepackage[onehalfspacing]{setspace}


%\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{letltxmacro}
\usepackage{graphicx}

\makeatother

\LetLtxMacro{\ORIGselectlanguage}{\selectlanguage}
\makeatletter
\DeclareRobustCommand{\selectlanguage}[1]{%
  \@ifundefined{alias@\string#1}
    {\ORIGselectlanguage{#1}}
    {\begingroup\edef\x{\endgroup
       \noexpand\ORIGselectlanguage{\@nameuse{alias@#1}}}\x}%
}
\newcommand{\definelanguagealias}[2]{%
  \@namedef{alias@#1}{#2}%
}
\makeatother

\definelanguagealias{eng}{english}
\definelanguagealias{en}{english}

\makeatletter
\let\l@eng\l@english
\makeatother

\usepackage{letltxmacro}

\usepackage{stringenc}
\usepackage{pdfescape}
\usepackage{subcaption}

\usepackage{mathptmx}

\hyphenation{da-ta-base da-ta-bases ex-pla-na-to-ry ex-plo-ra-to-ry BRA-VIZ}
\linenumbers

\def\keyFont{\fontsize{8}{11}\helveticabold }
\def\firstAuthorLast{Angulo {et~al.}} %use et al only if is more than 1 author
\def\Authors{Diego A. Angulo\,$^{1,*}$, Cyril Schneider\,$^{2}$, James H. Oliver\,$^{3}$, Nathalie Charpak\,$^{4}$, Jose T. Hernandez\,$^{1}$,}
% Affiliations should be keyed to the author's name with superscript numbers and be listed as follows: Laboratory, Institute, Department, Organization, City, State abbreviation (USA, Canada, Australia), and Country (without detailed address information such as city zip codes or street names).
% If one of the authors has a change of address, list the new address below the correspondence details using a superscript symbol and use the same symbol to indicate the author in the author list.
\def\Address{$^{1}$IMAGINE, Systems and Computing Engineering, Universidad de los Andes, Bogota, Colombia \\
$^{2}$LCNS, CHUL, Quebec , QC, Canada\\
$^{3}$VRAC, Iowa State University, Ames , IA, Unites States \\
$^{4}$Kangaroo Foundation, Bogota, Colombia }
% The Corresponding Author should be marked with an asterisk
% Provide the exact contact address (this time including street name and city zip code) and email of the corresponding author
\def\corrAuthor{Diego A. Angulo P.}
\def\corrAddress{Universidad de los Andes, Carrera 1 \# 18A -12 , Bogota, Colombia}
\def\corrEmail{da.angulo39@uniandes.edu.co}


\begin{document}
\onecolumn
\firstpage{1}
	
\title[Braviz: Visual Analysis of Brain Data]{A Multi-facetted Visual Analytics Tool for Exploratory Analysis of Human Brain and Function Datasets} 

\author[\firstAuthorLast ]{\Authors} %This field will be automatically populated
\address{} %This field will be automatically populated
\correspondance{} %This field will be automatically populated

\extraAuth{}% If there are more than 1 corresponding author, comment this line and uncomment the next one.

\maketitle

\begin{abstract}
\section{}
Brain research typically requires large amounts of data from different sources, and often of different nature. The use of different software tools adapted to the nature of each data source can make research work cumbersome and time consuming. It follows that data is not often used to its fullest potential thus limiting exploratory analysis. This paper presents an ancillary software tool called BRAVIZ that integrates interactive visualization with real-time statistical analyses, facilitating access to multi-facetted neuroscience data and automating many cumbersome and error-prone tasks required to explore such data. Rather than relying on abstract numerical indicators, BRAVIZ emphasizes brain images as the main object of the analysis process of individuals or groups. BRAVIZ facilitates exploration of trends or relationships to gain an integrated view of the phenomena studied, thus motivating discovery of new hypotheses. A case study is presented that incorporates brain structure and function outcomes together with different types of clinical data.

\tiny
 \keyFont{ \section{Keywords:}Exploratory Analysis,  Visual Analytics,  fMRI,  MRI,  Tractography,  Cohort Studies, Python}
\end{abstract}

\section{Motivation}


An important challenge in brain research, in both normal and pathological conditions, is to better understand the extent to which the physical structure of the brain influences its functioning. The most common research procedure is characterized by experiments aimed at collecting data directed towards testing a former hypothesis. This confirmatory-like methodology imposes limitations on the way data is used, and it is typically used only once which is unfortunate since data acquisition is generally time and resource intensive.


In the last two decades brain research data has increasingly been gathered in a more open fashion and many databases are now available to the public \cite{milham_open_2012}. In parallel, data collection, storage and sharing, have been improved at both technical and policy levels, have advanced \cite{eckersley_neuroscience_2003}, together with technologies used to consolidate, search and access the data \cite{van_horn_is_2009,wood_harnessing_2014}. This allows massive amounts of data to be consolidated into databases and searched in efficient ways. In this way questions can be explored and large data pools can be mined for interesting relationships.


This has led to rapid changes in the way research can be conducted, i.e., a shift from hypothesis-driven research into data-driven research, where data is available first and research questions and hypotheses are formulated on the basis of exploration of data. The methodology used in data-driven research differs significantly from that for hypothesis-driven research. Data-driven research seeks to find and extract meaningful insights from data using exploratory methods \cite{tukey_we_1980} and has already proven effective in economics, terrorism prevention and business intelligence domains which are characterized by large and heterogeneous data sets \cite{cook_illuminating_2005}. Exploratory research involves iterating through data several times, looking at it from different points of view, transforming data, searching for interesting subjects and measurements, gathering details and performing group analyses. These analysis tasks are carried out multiple times, and often in different order, as researchers learn more about the data. It is therefore helpful to provide tools to make annotations and save findings, so that explorations can be continued later as an integral part of the ongoing process of discovery.


During this process several data patterns may likely lead to unexpected insights. Unfortunately, it is also likely that these patterns are caused by the unique noise structure of the current data and therefore cannot be generalized to the global population. Automatic data-mining algorithms can find thousands of possible relations, but true findings need to be backed up by science and current knowledge.  Therefore, domain experts must be involved in interpretation of insights. Moreover, insights that integrate data from different domains require experts from all these domains.


Visual analytics \cite{keim_visual_2008} has emerged as a discipline that seeks to integrate statistics, machine learning, data mining and interactive data visualization with the objective of optimizing the use of data available for exploratory research. The analyst is acknowledged as the most important actor, and all tools are designed to support exploration and provide timely access to the required data as well as to informatics and statistics functions. Another principle in visual analytics is that analysts should focus on data and not on operational details of the tools. Therefore, tools should provide the data and functionality to complete the task, while keeping non-relevant details and complex functionality hidden.

Exploratory brain research is a domain that could certainly benefit from visual analytics techniques. Indeed, brain function-related datasets are a combination of spatial (brain imaging) and non-spatial (clinical) measurements that could be analyzed together to better understand the link between brain structure and function as they relate to human health and behavior. Examples of spatial measurements include brain anatomy acquired by means of magnetic resonance imaging (MRI), neural pathways trajectory acquired by diffusion weighted imaging (DWI), patterns of cerebral activation in specific tasks and acquired by functional MRI (fMRI), or brain networks functionality and corticomotor function tested by transcranial magnetic stimulation (TMS) of motor and non motor areas of brain. Specialized tools can process these neuroimaging modalities to model brain structure, build pathways, produce statistical maps of activation patterns and neural connections. Brain researchers need to correlate these neurophysiological measurements and models to data of a different nature, such as neuropsychological performance, behaviors and other clinical data.


However, the tools currently used in brain research are generally specific to the type or domain of data analyzed and they are optimized to support linear work flows. It follows that experts must often switch between tools to integrate and analyze data from different domains. In the worst cases, they may even have to move to a different computer. This process is time-consuming and repetitive. It requires the analyst to focus attention on the ``how'' rather than the ``what'', and thus makes exploratory analysis challenging.
					
\section{Introduction}

This paper introduces BRAVIZ, a software tool based on visual analytics and aimed at supporting exploratory analysis in brain research. More specifically, it focuses on datasets that include MRI derived measurements and models 
as well as TMS and clinical outcomes. BRAVIZ is comprised of several applications that integrate interactive visualizations, links to detailed meta-data, creation of new variables as well as statistical models and analyses, all of which are designed to support and facilitate full exploratory analyses. It is implemented on python and available under an open source license.

\section{Related Work on Neuroimaging and Exploratory Analysis}


Several data processing and visualization tools are available to support research on neuroimaging. For example, Freesurfer \cite{fischl_freesurfer_2012}, FSL \cite{jenkinson_fsl_2012} and SPM \cite{friston_statistical_2006} segment, register and perform statistical testing of brain image data. 3D Slicer \cite{fedorov_3d_2012}, Brain Visa \cite{cointepas_brainvisa:_2001} and ITKSnap \cite{yushkevich_user-guided_2006} are commonly used to integrate data from different image modalities (structural, diffusion-weighted, functional among others). They have all proven to be efficient at processing bulk images in a pipeline, and visualizing data from a single subject, but they fall short when several iterations through the data are required. The interfaces proposed for statistical testing require extensive configuration, which is appropriate for testing specific hypotheses, but becomes cumbersome when several possibilities are to be explored. Efficient mechanisms for restricting analysis to only a subset of subjects   (e.g. with common clinical or lesion characteristics) or going back to a subject's details are missing. Complementary data loaded from tables can be used, but changing variables often means creating new tables and making them fit the required format.


Non-spatial information visualization tools like GGobi \cite{cook_interactive_2007}, and Tableau\cite{hanrahan_tableau_2003} can be used for interactive exploratory analysis. They support data transformations, model fitting, and interactive visualization. They also enable  detection of outliers (important in data-driven research whereas usually unnecessary in hypothesis-driven research), provide additional details, determine subsets of subjects, and visualize patterns and trends in different ways (e.g. parallel coordinates, scatter plots, histograms, etc). However, these tools do not integrate well with spatial data. Scalar data derived from original images can be added but there is no easy way to link back to the original data or to explore spatial features that cannot be encoded into numerical variables.

INVIZIAN \cite{bowman_query-based_2011, bowman_feature-similarity_2012, bowman_visual_2012} uses Ggobi options to explore, in an abstract 3D space, the relations between scalar values and anatomical features of large brain datasets. It provides an environment for exploratory research involving data from several databases for hypotheses generation. However, it works only with automatic feature extraction from structural MRI. Like BRAVIZ, INVIZIAN focuses on easing the users' visual pattern search, however BRAVIZ targets a broader range of spatial data, and focuses on data generated by users rather than on machine learning. 


A visual analysis tool for high dimensional genetic and clinical data is presented in \cite{hinterberg_peax:_2014}. The user explores the data by quickly iterating through several models that relate genetic data to clinical outcomes. Models are displayed as trees and linked with distributions of the selected parameters. Tools are provided to automatically find the most relevant parameters to reduce the size of the search space. This tool is optimized for a single type of data, a single type of model and a specific workflow. In contrast, BRAVIZ proposes to support multiple tasks, data types and workflows by providing a set of  applications to be used independently or combined for complex exploratory analyses, as for example to interactively probe the multifaceted relationships between spatial and non spatial outcomes at the level of individuals, subsets of subjects or group of subjects.
	
Even though multiple tools  exist for analysis and exploration of spatial and non-spatial data, the integration of multiple kinds/levels of analyses and data in a single environment remains challenging. BRAVIZ provides a unique unified environment for analyzing spatial and non-spatial data interactively, and in this way, it supports data-driven research.

\section{BRAVIZ Architecture}

Figure \ref{fig_arch} shows the BRAVIZ architecture is based on the Model-View-Controller pattern, where the bottom layer (Project reader) together with the data repository constitute the model. The  BRAVIZ Library (shaded region) makes up the controller, and each application represents a different view.

Instead of a large monolithic application, BRAVIZ takes a distributed approach and thus is comprised of a set of applications tailored towards specific analysis tasks and data types. 
New BRAVIZ applications are implemented based on the common library, freeing developers from thinking about technical details related to data manipulation. All applications use the same data repository, which provides a channel for data sharing. Users can create custom samples, new variables and custom geometric structures and store them in the database, where they can be read by any other BRAVIZ application. An additional communication mechanism is provided that enables applications to exchange data in real-time. In this way individual applications can be combined to solve more complex tasks. Subsection \ref{braviz_apps} will describe current applications.

The library provides tools for loading spatial data (and transforming it into an appropriate coordinate system), for manipulating tabular data, for creating spatial and non-spatial interactive data visualizations, and for interacting with other applications and between different users. The types of spatial-data supported by the current implementation are: structural MRI, diffusion MRI, functional MRI, label maps, tractography reconstructions, structure segmentation models and Freesurfer cortex reconstructions. Non-spatial data can be any numeric or categorical variable, including TMS, clinical and socio-economic data. More details on the Braviz library will be given in subsection \ref{braviz_lib}. 

\subsection{Design and Development Methodology}

A ``user centered'' approach \cite{wassink_applying_2009} was taken to design and implement BRAVIZ. The authors worked closely with brain researchers of several specialties, visited several labs and hospitals, and learned as much as possible about research workflows and the bottlenecks they contain. Prototypes were implemented in several iterations and shared with different domain experts, whose feedback motivated the design of the next generation.
The initial stages of design focused on identifying the obstacles that affect exploratory analysis and communication between experts, and examined ways of mitigating them. The team of experts was composed of radiologists, psychiatrists, physicians, neurophysiologists, physical therapists, pediatricians, statisticians, engineers and economists.

From analyzing the visualization options in current neuroimaging tools, as well as how domain experts used them, the BRAVIZ team learned what was expected from image viewers, i.e. which features were important to implement and which were seldom used. SPM \cite{friston_statistical_2007}, Osirix \cite{rosset_osirix:_2004} and 3D-Slicer \cite{fedorov_3d_2012} were the reference at this stage. For example, researchers needed to visualize several types of data in the same space and to be able to compare brain images between two subjects. Also obvious was the need to integrate spatial visualizations with non-spatial data for the same subject in order to be able to understand relationships. Another common issue discovered in this exchange with expert users was that navigation from one subject to another typically requires re-starting the visualization application which is cumbersome. 

In addition, there was the need for performing statistical analysis in real time, working with different groups of subjects in the same space, creating and importing new data on the fly, performing group analyzes, identifying outliers and detecting data quality issues. 


\subsection{Applications Set}
\label{braviz_apps}

The current set of BRAVIZ applications can be divided in three categories. One set of applications measures or creates new descriptors from geometric data, one displays geometric data using other variables as context, and the third explores numerical and categorical data. This supports different stages of the exploratory analysis process, respectively, data transformation, visualization and subjects-to-group analyses. These applications are accessible from the main menu \ref{fig_menu} by clicking on the corresponding buttons. The bottom row provides access to utilities to manage samples, variables and scenarios, as well as importing and exporting data. 

\subsubsection{Descriptors for geometric data}

The \emph{Region of Interest (ROI) Builder} application (Figure \ref{fig_roi}) provides an interface for helping experts position a spherical ROI within the brain of each subject. These spheres are placed and sized with respect to images (from any modality) or cortex reconstructions. It is also possible to preview the fibers that cross the ROI, and to evaluate mean value inside the sphere of any scalar image, for example mean FA (fractional anisotropy associated to the integrity of myelin covering axons) or mean t-value associated with an fMRI test (representing to what degree a region is involved in a given task). 
Linear and non-linear registration maps can be used to approximate the position and size of the sphere in other subjects. The expected workflow is positioning the ROI in one subject, extrapolating it to a sample and making fine adjustments in position and size. The interface is optimized to support this (buttons, hotkeys and visualization). Several ROIs can be used to select specific or more complex bundles. All data generated in the application (ROIs, bundles and scalars) can be used on any other BRAVIZ application. 

In addition, the current BRAVIZ implementation includes an application for making linear measurements (lengths) of brain structures, and an application (\emph{Logic Bundles}) for defining fiber bundles by combining ROIs and segmented structures through logical operations. For example, a bundle may be defines as the fibers that go through structure $A$ or ROI $B$ but that don't cross structure $C$. 


\subsubsection{Geometric Data Visualization}

The \emph{Subject Overview} application is shown in Figure \ref{fig_subject}. This tool  provides access to several kinds of spatial data in a unique 3D renderer and eases the rapid navigation of the data from one subject to another. Geometrical features such as MRI volumes or mean fractional anisotropy of DWI in relation to a chosen structure can be captured directly from this application and added to the database as a new variable. The application also shows the values per subject of selected variables as well as users' annotations. This ensures an integrated overview of each case and follow-up between different users depending on the data available to BRAVIZ.

A small multiples display \cite{tufte_visual_1983} with views  of several subjects is useful for finding trends across a sample or for quality control to detect contaminated images. Subjects are ordered from left to right according to a chosen numerical variable and each row corresponds to a nominal variable. In the example presented in Figure \ref{fig_sample} the three rows are term children, preterm controls and preterms with Kangaroo Mother Care intervention (see case studies in Section \ref{case_studies}) and subjects are sorted from left to right according to the score on an IQ test. The bar-plot at the right shows the distribution of this test amongst the three groups. This plot is linked with the 3D views, thus clicking on a bar will bring the corresponding subject into view. If more details of any subject are required, the user may right click on that subject’s image to load the corresponding subject on other BRAVIZ applications.

The \emph{fMRI Explorer} application from Figure \ref{fig_fmri} displays raw BOLD signals and contrast designs associated with fMRI experiments. It can also be used to compare signals at different locations or from different subjects. The \emph{Check Registration} application allows the user to visualize simultaneously two images, from different modalities or different subjects and in a given coordinates system to assess the quality of registration.

\subsubsection{Numerical and Categorical Data Exploration}

The \emph{ANOVA} application (see Figure \ref{fig_anova}) provides access to statistical models implemented in \emph{R} \cite{team_r:_2012}. In order to fit a model the user needs to select a sample an outcome variable, regressors and interaction terms using the controls on the left side. These variables are selected from the database, which additionally stores the type of each variable, its description and in the case of nominal variables the labels for each level. The variable selection dialog shows this meta-data for each variable and allow users to modify it, it also displays an overview plot of the variable which allows the user to infer the distribution of values. This plot can also be configured to show the relationship between two variables (outcome vs regressor) so that the user may do a preliminary visual assesment of which variables can be related. Finally, the dialog provides mechanisms to search the database. When the user finishes selecting the appropriate variables and clicks the calculate ANOVA button; the system will fetch the values for the selected sample, and fit the model using the \emph{CAR} package of R. 

After fitting the model the main plot will show diagnostics (distribution of residuals and a scatter plot of residuals vs fitted values) for validating the ANOVA hypotheses (normally distributed noise with constant variance) and the table at the bottom right shows the resulting statistics. The application can also show box-plots and scatter-plots which provide additional insight on the relation between regressors (nominal and numeric variables and interaction terms) and outcome. Individual points in these plots may be identified by positioning the mouse over them. Additionally, by right clicking the associated individual subject data can be loaded into other BRAVIZ applications to get additional information. This can be especially useful for instance to interpret outliers.

Figure \ref{fig_lm} shows an alternative analysis application (\emph{Linear Model}) which fits standard linear models and shows the effect of each regressor (numerical variables, dummy variables representing levels of nominal variables and interaction terms). The application provides a similar interface and functions in the same way as the ANOVA application. The example from the figure shows a linear regression between the average length of fibers going through the posterior section of the corpus callosum and the results of a visual intelligence test (see case studies in section \ref{case_studies}).  

The \emph{Correlations} application shown in figure \ref{fig_correlations} displays a list of variables, a correlation matrix of selected variables, and scatter plots of selected correlations. Points in the plot can be queried and right clicked. Additionally, they can be temporarily eliminated from the analysis to see the impact they have on the tested correlation. 

The \emph{Parallel Coordinates} display from figure \ref{fig_parallel} provides another way of analyzing relations involving several variables . This functionality is display for the second case study presented thereafter (see Figure \ref{fig_parallel} ). Each vertical axis represents a variable, and each line is a subject. Users can interactively apply filters to each axis, in order to see how changes in one variable affect other values, and to understand relations involving several variables. In the figure gray lines represent subjects excluded by the filters while color lines are those subjects that match the filters.

\subsection{Common Features}

%\subsection{Global BRAVIZ Features}
In addition to the unique features of each BRAVIZ application, the integrated platform provides features and combinations of tools (designed to be used together) in order to specifically favour the complex process of exploratory analyzes.

%that directly support exploratory analyzes. In addition, tools are designed to be used together and combined to support complex analysis processes.

\subsubsection{Linking Clinical Outcomes and Brain Data}

Subjects in BRAVIZ are an integral part of the process, and therefore all types of data per  subject is always accessible. For example, the \emph{Subject Overview} application displays a set of clinical variables and annotations together with spatial data. It follows that users of BRAVIZ can make a context-dependent reading of images and of other spatial data. Such information would only be displayed elsewhere by other tools.

%This added context lets researchers make a more accurate reading of images and other spatial data. With other tools, researchers would need to seek this information elsewhere. 

Several scalar measurements can be derived from spatial data within the tool itself. For example a group of segmented structures can be selected and their combined volume added as a new variable. These values can afterwards be used together with clinical variables for statistical analysis, but a link is kept between the initial data and the environment in which it was generated. Continuing with this example, if the researcher finds an outlier, she/he can right click on it and from the context menu open the application in which the odd value was generated. The application will load with the configuration it had at that time, but focused on the subject of interest. In this way the extreme value can be analyzed to determine if it is caused by a particular artifact of the subject, such as a segmentation error, a problem with the image, or a sign of an actual pathology.

%It follows that any outlier could be right clicked and better understood by opening (from the context menu) the application in which it was generated, i.e. this allows to check the configuration that the outlier had originally but in the context of analysis. In this way the extreme values can be explored to determine if it was caused by a particular artifact of the subject, such as a segmentation error, a problem with the image, or a sign of an actual pathology.

\subsubsection{Comparing Subjects}

A common task in exploratory research is analyzing similarities and differences amongst a group of subjects. In most existing visualization tools for spatial data, users have to select the subject of interest at the onset of analysis, and then configure all the visualization options and load the necessary files. BRAVIZ takes a different approach, and always allows the subjects of interest to change in the middle of the analysis while maintaining the configuration of the application. In this way it is easy to look at different subjects from the same point of view, which makes comparing data very efficient.  

\subsubsection{Working with Samples}
\label{subsamples}
Often some properties of the data apply only to a specific group/sample of subjects. In BRAVIZ samples are a central component of every analysis. Samples can indeed be defined by using filters on variable values, manually adding and removing specific subjects, taking random subsets, or combining samples through set operations (union, intersection and difference). 
These samples can then be used for iterative analyses between different groups or can be modified (e.g., withdrawal of outiers), and the results of the modification visualized in real time. This contrasts with hypothesis-driven research where the sample must be set at the onset of analyses.


%These samples can then be used throughout the tool, which allows repeating analyzes for different groups. They can also be modified, for example to remove pathological data points, and the results of the modification visualized in real time. In contrast, most tools oriented towards confirmatory research require the sample to be set at the start of the analysis.

\subsubsection{Working with incomplete data}

It is not uncommon for some values or geometric data to be missing in some subjects. Applications that show geometric data detect missing data, hide the corresponding object from the scene, and display warning in the status bar. Group analysis tools display the number of missing points, and ignore them when performing calculations. Also, when building samples, the using filters the interface provides a checkbox that allows the user to include or exclude subjects with a missing value for the specific variable studied.

\subsubsection{Supporting Long Workflows}

Analyzing a complex dataset requires a significant amount of time, and will likely be split in multiple sessions. BRAVIZ applications allow saving analyzes and restoring them using custom names and descriptions, and attaching textual annotations to subjects, variables and geometric objects (for example ROIs), and thus favors re-use of previous explorations. A log of each analysis session is kept, which can be reviewed and annotated using a web interface. These features allow other users to understand the meaning of variables, geometric structures and scenarios created by colleagues thereby favoring collaboration. 

\subsubsection{Integrating Tools}

In addition to the common database where all tools read and store variables and geometric objects, BRAVIZ includes a real-time communication mechanism. All applications can be coordinated to focus on the same subject (see Figure \ref{fig_imagine}), to work with the same sample, or use the same set of variables. Applications may be running on different screens or even different devices; allowing users to get different perspectives of the data at the same time. Of note, BRAVIZ applications have the option to block specific parameters to keep the application from changing if the user prefers it. Also, for some actions that are likely to produce important changes, BRAVIZ asks the user for confirmation, and provide the option to always accept or always ignore the specific change.

Multiple users can work with the same data base thus can share data and thoughts. In this way one user may create a new measurement and make it available to other users. Real-time communication is implemented through TCP, therefore it would be possible to link together multiple workstations, but the research team has yet to explore whether this would provide a convenient user experience.

\subsection{The BRAVIZ library}

\label{braviz_lib}
The Braviz library (shaded region of Figure \ref{fig_arch}) is divided in three modules that provide several common features to ease the development of applications. In addition, it abstracts access to data so that applications can be ported to different datasets. Of note, BRAVIZ library can also be used in python applications and scripts, including interactive work in a terminal or an iPython notebook.

\subsubsection{Read and Filter}

The \emph{Read and Filter} module is in charge of reading the configuration file and instantiating the appropriate project reader class. In addition, it holds several utility functions for converting image data between formats, applying affine transformations, filtering tractography and deriving scalar measures from scalar data. This module also abstracts reading and writing data from the BRAVIZ database. Currently this database is implentend in \emph{SQLite} \cite{hipp_sqlite_2015} and it holds all non-spatial data, samples, scenarios, and other objects created by users.

\subsubsection{Visualization}

The Visualization module contains functions and widgets that can be used to create spatial and non-spatial visualizations. Spatial visualizations are implemented with VTK \cite{schroeder_design_1996} , but several classes are available to streamline development. For example, \emph{managers} are available for tractography, fMRI and segmentation data. These are high-level classes that connect to the \emph{Read and Filter} module, load the appropriate data, and manage the VTK visualization pipeline ending in a specified renderer. The user only needs to provide the current subject, current coordinate system, and visualization parameters. 
Of note, these classes expose methods as \emph{change\_subject} and \emph{change\_coordinates} which conveniently allows switching to a different subject or a different coordinate system.

Non-spatial visualizations use Matplotlib \cite{hunter_matplotlib:_2007} and Seaborn \cite{michael_waskom_seaborn:_2015}, or D3  \cite{bostock_d3_2011} in case of web based applications. This module provides functions to create common visualizations by providing an input data-frame and other configuration parameters. All BRAVIZ visualizations exhibit consistent behavior, i.e. they  allow the user to query the subject id of a data point by hovering over it, create a context menu by right clicking on a point, and allow for highlighting points on the display. 

\subsubsection{Interaction}

The \emph{interaction} module includes common QT widgets as well as utilities to create web based applications and to handle communications between applications. It also handles connection to external tools. For example, it contains functions that use the \emph{R} system to perform statistical analysis. 

\subsection{Importing data into BRAVIZ}

As mentioned above, making BRAVIZ generalizable to support different data-sets and data-formats was a primary design goal.
In order to use BRAVIZ on an existing data-set, spatial data should be pre-processed using standard neuroimage tools. Instead of copying spatial data, BRAVIZ access it using specific \emph{ProjectReader} classes. Finally several options are available to import non-spatial data.

\subsubsection{Pre-processing}

While BRAVIZ integrates some basic image processing algorithms, the focus remains on interactive visualization. In this end,  data should be pre-processed using third party tools before starting a BRAVIZ project. As a minimum, BRAVIZ expects registration matrices linking the different coordinate systems present in images. Running the FreeSurfer \emph{recon\_all} pipeline will provide BRAVIZ segmentation, cortical parcellation and Talairach registration, which are basic for most visualizations. 

In addition, BRAVIZ can read SPM statistical maps and warp fields as well as tractography output ( currently in VTK format ), Tracula bundles and any type of scalar map, for example those derived from the tensor model.

Pipeline systems such as LONI pipeline \cite{dinov_efficient_2009} or NiPype \cite{gorgolewski_nipype:_2011} are ideally suited to automate these necessary pre-processing steps.

\subsubsection{Reading Spatial Data}

BRAVIZ accesses geometric data through the project reader interface (see figure \ref{fig_arch}), which can have different implementations for different projects. All the upper layers, including applications, will access data through \emph{ProjectReader} objects by specifying the type of data, the subject id, the coordinate space  and additional parameters appropriate for each data type (e.g. scalars for tractography or contrast for fMRI maps). This object is also responsible of returning indices of available data. Internally the class must be able to load the appropriate data, apply the correct transformations and finally return the requested data as a python object. 

For example, in the case study presented below, all project's data was stored on hard disk, using NIFTI format for images, and VTK format for tractography and segmented structures. Files were stored in a layout such that the full path for each file can be determined based on subject id. Pre-calculated transformation matrices and warp fields were located and internally applied on load.

New reader classes can be implemented to read data from different sources and different formats (e.g. reading DICOM objects from a PACS). The nibabel and vtk python libraries provide functions to load data stored in several formats, making the implementation of these classes feasible in a short amount of time.

It is noteworthy that setting up BRAVIZ to work with a new dataset requires expertise from engineers. Recall that BRAVIZ is targeted at interdisciplinary teams and one of the goals is allowing the members of these teams to work together efficiently. Additional details of how BRAVIZ handles spatial and non-spatial data are described in the project's documentation. 

\subsubsection{Importing Non-Spatial Data}

By means of integrated tools clinical data can be imported into the system from excel tables or SPSS files using integrated tools. This data is copied into a database, and can be accessed from all applications. The python terminal or iPython notebooks \cite{perez_ipython:_2007} can also be used to interactively read data from other sources (for example scraping web sites or by parsing DICOM headers), transform it into a pandas dataframe, and save it into the BRAVIZ database using a high level API.

Of note, additional data can be added at any time and non-spatial data can also be exported to an spreadsheet using a graphical interfaces. It follows that the user is able to take some variables of interest out of BRAVIZ, perform calculation on an external tool, and import the results back into BRAVIZ.

%Review 1a



\section{Case Studies}
\label{case_studies}
The functionality provided by BRAVIZ can be used both for untargeted, intuitive and adaptive discovery of relationships in order to improve understanding of data; as well as for structured dissection of data. In subsection \ref{sec_case_cyril} an example of adaptive data exploration is presented. Subsection \ref{sec_pvm_case} illustrates pre-structured, targeted exploratory analysis to identify potential candidates for a sub-analysis of leukomalacia in a cohort of adolescents followed since birth. 

In these case studies, MRI, fMRI and diffusion data were acquired, anonymized and stored in DICOM format, then pre-processed using dcm2nii \cite{rorden_mricron_2007}, fsl\cite{jenkinson_fsl_2012}, freesurfer \cite{fischl_freesurfer_2012}, camino\cite{cook_camino:_2006} and spm \cite{friston_statistical_2007}. A custom BRAVIZ project reader was implemented to read the output of this process. 
Clinical data was primarily consolidated in an SPSS database then imported in BRAVIZ. These tasks were performed by the engineering members of the group. Afterwards, researchers were free to explore and analyze data with BRAVIZ on their own computers. The first case study was carried out by a neurophysiologist, while the second one was completed by a  pediatrician and a neuro-radiologist. 
	
 
\subsection{5.1 Adaptive exploration of anatomical and functional data in prematurity}
\label{sec_case_cyril}

This section describes an adaptive inference process in which insights inspire subsequent exploratory steps, and, more specifically, highlights the flexibility that BRAVIZ affords.

\subsubsection{Rationale and initial hypotheses}

Data comes from the seminal demonstration \cite{schneider_cerebral_2012} of the influence of a very premature birth ($<$ 33 weeks of gestational age) on brain function in a sample of 15-year old adolescents who were compared to their term peers. This study also showed the positive impact of an early care protocol (Kangaroo Mother Care) on brain functions, but this is beyond the present topic. The authors used the noninvasive and painless transcranial magnetic stimulation (TMS) of the primary motor cortex (referred to as the motor brain) and showed that the control of hand by brain was suboptimal in the preterm group. Especially, the excitability of the motor brain was lower and the time required for the transfer of nervous signal from one cerebral hemisphere to the other (interhemispheric transfer) was longer. These abnormalities were related to the deleterious after-effects of a premature birth that could still be detected 15 years later in brain  \cite{schneider_cerebral_2012}. Indeed, the interruption of the in utero maturation of the corpus callosum, a structure comprised of large-diametered fast-conducting myelinated fibers and connecting the two cerebral hemispheres, interfered with the normal installation of circuits in each hemisphere and of the functional lateralization between hemispheres, thus altering the sensorimotor and cognitive brain function \cite{schneider_cerebral_2012, schneider_visuo-motor_2008, flamand_brain_2012}.

However, the study had not yet established any link between MRI-DTI measurements of the corpus callosum thinning and the lower clinical performances in the preterm group as compared to the peers term. Two reasons can explain this limitation:  the difficulty to statistically analyze, visualize, explore and understand the link between outcomes of different nature (severely time-consuming with the use of different softwares and data transformations likely providing biases or mistakes); the required involvement of experts dedicated to the interpretation of each outcome.

The working hypothesis was that BRAVIZ‘s user-centered approach and applications/modules with real-time statistical analyses (color coding for instantaneous detection of a correlation for example), and access to multifacetted neuroscience and clinical data (spatial and non-spatial interactive data visualizations with common operations available between applications) should favor multi-tasking along with adaptation to user's expertise leading to easy detection of outliers and emergence of unsuspected relationships between target variables.


\subsubsection{Contribution of BRAVIZ to scientific discovery (ancillary hypotheses)}

All data had been already imported in BRAVIZ by the engineer before onset of work and this substantally fastened the access to spatial and non spatial data. BRAVIZ was used to explore the potential links between clinical outcomes and lower excitability of the motor brain, interhemispheric dysfunction, and volume / numbers of fibers of the corpus callosum. The applications were used following the non linear procedure that BRAVIZ uniquely supports. ANOVA results with scatter plots, standard deviations and superimposition of individual values helped immediately detect four outliers in the 15-year preterm adolescents’ sample. This should have taken far more time with other applications not processed by BRAVIZ in real time and in parallel. The \emph{Correlation Viewer} allowed to remove these outliers with a simple click and to see instantaneously that they affected ANOVA results, which would not have been possible to detect if all applications had not be launched in the same workspace. Thus, the combination of \emph{ANOVA}, \emph{Correlation Viewer} and \emph{Parallel Coordinates} (MRI for structure volume, DTI for fibers) showed that,  without the outliers (studied below), the medial-anterior part of the corpus callosum (maCC connecting the motor areas between hemispheres) was smaller in volume in the preterm group ($17228 \pm 5100 mm^3$) than in the term ($22352 \pm 3900mm^3$; p = 0.02) and exhibited fewer callosal fibers ($1806 \pm 573$) than in the term ($2600 \pm 570$; p = 0.008). Despite this thinning of corpus callosum, no link was detected with the interhemispheric time of transfer between motor areas that was shown to be significantly longer in the preterm group \cite{schneider_cerebral_2012}. However, the correlation matrix and scatter plots brought to attention that, by withdrawing the four outliers, a strongly red-colored (significant) link appeared between  the interhemispheric transfer time and the length of the maCC fibers: Figure \ref{fig_cyril_1} shows this strong correlation for the preterm group (black circles) when the outliers are removed (stars), the longer the maCC fibers and the longer the interhemispheric transfer time. This correlation was absent in the term group (empty circles). 

The real time access to clinical characteristics by right clicking the dots in BRAVIZ’s scatter plots eased to understand that three stars in Figure \ref{fig_cyril_1} were participants with either cerebral palsy or Xfragile pathology. The parallel access DTI data and scatter plots in the same workspace  favored the immediate detection that the circled star in Figure \ref{fig_cyril_2} was a participant with a dramatic thinning of the maCC (Figure \ref{fig_cyril_2}). This explains that, as compared to other participants with shorter length of maCC fibers,  the interhemispheric transfer time was longer (holes in corpus callosum likely leading to temporal dispersion of current between hemispheres).  We already knew that the preterm group had longer interhemispheric transfer time \cite{schneider_cerebral_2012} but BRAVIZ guided the analysis to rapidly visualize and test that this was related to the length of fibers in the preterm group, even if length was not different than in the term group. This contributes to raise the very new hypothesis that the underlying problem in our preterm sample may not not be the structural defect (excluding the outliers) but more likely the synaptic arrangement of connections between hemispheres, those with longer interhemispheric transfer time presenting with less efficient transcallosal networks.

Precisely, not all participants in the preterm group presented with lengthened interhemipsheric transfer time but five of them were over 20ms (over the horizontal dotted line) when 8ms and 14ms are usually expected for men and women, respectively \cite{schneider_cerebral_2012}. BRAVIZs parallel coordinates of the different variables was useful once again to efficiently identify that four out of these five participants over 20ms had a transient score at the infant neurological international battery (Infanib) at 6 months of age. This intuitively led to launch BRAVIZ’s  \emph{Correlation Viewer} and to highlight a strong link between Infanib at 6 months of age and our neurophysiological measures known as different in the preterm group \cite{schneider_cerebral_2012} such as the lower excitability of the motor brain and higher occurrence of ipsilateral muscle responses to TMS of the motor brain (which is abnormal given the typical crossed organization of motor systems for hand function). In that vein, BRAVIZ’s applications contributed to highlight that the four participants above 20ms thus who significantly drove the correlation in Figure \ref{fig_cyril_1} had a dysfunctional organization of the motor brain. One another ancillary hypothesis could be that Infanib testing at 6 months of age may be predictive of long-term impairment of the motor brain function, including a poor efficiency of the interhemispheric connections (time over 20ms at 15 years of age, see Figure \ref{fig_cyril_1}).

Merging the neurophysiological expertise with the potential of BRAVIZ for data-driven analysis led to  one last interesting new finding in this case study. This concerns the visuomotor control of movement which involved the corpus callosum function \cite{schneider_visuo-motor_2008} and which is assessed by the standardized score of the visuomotor integration test (VMI StS). This score was found to be significantly lower in the preterm group ($95.5\pm7$) than in the term ($108.5\pm3.5$; p = 0.0001) at 15 years of age. The \emph{Correlation Viewer} (color codes highlighting the significant links and excluding the outliers determined above) used together with the parallel coordinates application (see all studied variables in real time in the same workspace) detected  that the lower (lesser) VMI StS scores of the preterm group could be explained by a lower excitability of the motor brain (higher motor threshold i.e. higher intensity of TMS to generate a response in the muscle, “RMTd” in Figure \ref{fig_cyril_4}, the excluded outliers are represented as empty circles) and higher occurence of abnormal ipsilateral responses (“Ipsifreqnd” in Figure \ref{fig_cyril_5}). By extension, BRAVIZ afforded applications and context to detect that the impairement of visuomotor control of movement in our sample of 15-year adolescents born prematurely was related to dysfunction of the motor brain and pathways, in terms of maladaptive synaptic organization (rather than anatomical issues), and that could have been predicted by the transient Infanib at 6 months of age. Overall, these new hypotheses driven by BRAVIZ in our sample of preterm adolescent may impact early rehabilitation when synaptic issues are more sensitive than anatomical to training-induced mechanisms of adaptation and motor learning.

\subsubsection{Conclusions}

BRAVIZ adapted and intuitively guided the exploratory analysis of these multi-kind and multifacetted outcomes. With different experts gathered (i.e. neonatologist, neurophysiologist, psychologist, physical therapist) this new tool helped unmask important relationships between variables of brain function and uncover new hypotheses in prematurity that go beyond previous works in preterm children \cite{schneider_cerebral_2012, schneider_visuo-motor_2008, flamand_brain_2012}. BRAVIZ-related analysis of experimental data in prematurity pointed out for the first time that the long-term impairments (clinical data) in prematurity may not be the smaller volume of some structures but the lesser efficacy of synapses between neurons and of networks between structures (such as the corpus callosum between hemispheres). On that vein, a specific focus, in terms of quality and intensity of intervention for synaptic efficiency, should be made on those individuals presenting characteristics that BRAVIZ unique exploratory analysis has identified at risk for the integrity of brain function.
Our
  
\subsection{Pre-structured, targeted search and characterization of leukomalacia patients}
\label{sec_pvm_case}

Periventricular Leukomalacia (PVL) is characterized by a lesion in the periventricular germinal matrix which results in a loss of white matter ventricular dilation. Preterm babies, especially those born prior to 33 weeks of gestation(due to non invagination yet of highly vascularized germinal matrix) present with a significant risk of suffering from this condition and from its long-term physiological consequences, including motor and vision impairments, cerebral palsy and epilepsy.

Of note, the imaging protocol of the study did not include FLAIR images which are most appropriate for  PVL detection. BRAVIZ and its applications thus offered the alternative to identify in the database for subjects who might possibly suffer this PVL condition. Such exploration targeted a better understanding of the sample’s health issues rather than directly testing a scientific hypothesis. However incidental results may result from BRAVIZ’s data-driven analysis.

A parallel coordinates display was used to visualize the ventricles volume and the total white matter (myelinated fibers comprising brain networks). Figure \ref{fig_parallel} shows for example that the dataset included motor and visual testing, intelligence assessment, a classical neurological evaluation to discriminate between  normal and abnormal neurological status and some risk factors, such as weight and gestational age (Ballard) at birth. Data could be filtered by axis dragging in order to keep only subjects with high ventricular volume and low white matter volume (shown in color at the figure, while excluded are shown in gray), i.e. with characteristics related to PVL condition. Lines (one line per participant) with decreasing slope from first segment (ventricules volume) to second segment (white matter) may reflect ventricular dilation (first segment) as a result of the loss of white matter, in relation to neurological status (abnormal in red and normal in blue). 


The line highlighted in Figure \ref{fig_parallel} showed ventricules dilatation, low white matter volume, low scores for motor and visual components of visuomotor integration testing (VMI) and low birthweight (pesnacer). The context menu that appeared by right clicking on the line enabled to  switch  to the individual's brain facts, images and statistics in other BRAVIZ applications and to get additional details for better understanding the whole clinical profile of such an abnormal condition at 15 years of age. For example, the Subject Overview application denoted that the participant was born by C-Section in emergency after a twin pregnancy; the mother had HELPP syndrome (malignant hypertension) and died after giving birth; the abnormal status during the first year of life transformed in a diagnosis of cerebral palsy at the end of the first year (spastic diplegia and right arm hemiparesis). Altogether, the clinical profile and the symptoms together with the T1 image of ventricles dilatation (Figure \ref{fig_subject3}) could be associated with PVL.

The 15-year subject data associated with the top line in Figure \ref{fig_parallel} (highest ventricles volume) showed in  Subject Overview  a very premature birth at 31 weeks of gestational age and given by C-section in emergency because of profuse bleeding (placenta previae), signs of leucoencephalopathy and an increased volume of the left lateral ventricle in CT scan, epilepsy not yet controlled, severe bilateral hearing loss and abnormal bilateral vision, but a normal psychomotor development. BRAVIZ’s coordinated applications looking at indicator variables then at candidates' detailed profiles detected two cases with possible existence of PVL out of our sample of participants, although the original data had not been collected with the view of evaluating such white matter disorders. This witnessed the usefulness of the \emph{Subject Overview} application to provide sufficient information to better understand each case and its life trajectory (variables, annotations) with no need to gather additional files.

\section{Discussion}
\label{sec:disc}

The cases studies illustrate how BRAVIZ can be used to improve understanding of a real data-set. 
A direct access to data makes researchers more efficient in the exploratory analysis and the recovery of data relevant to their questions. By combining several tools, users can perform group level analyses without loosing track of individual subjects, while getting additional details on a participant via a simple click. Sharing samples, variables, visualizations and subjects of interest also provides an efficient channel for experts to communicate and share ideas, thoughts, advice and opinions with each other.

Direct access to data helps save time and more interestingly, enables researchers to efficiently pursue and address in real time all questions coming to mind. If testing an idea, hypothesis of relationships or finding an answer requires a cumbersome procedure and gathering data from several sources, it will likely not be explored. This exploration would take non intuitive manipulation of different softwares and far more time with elevated risks of biases and mistakes in data transformation, etc. With BRAVIZ, the number of questions that can be addressed are increasing and so are the chances of finding incidental but interesting results.


Combining clinical and spatial data with the unstructured clinical history allows researchers to reconstruct a full picture of each subject. This is valuable for making accurate interpretations of results, for understanding deeper and more accurately the dataset and its outliers. Participants in BRAVIZ are always linked to all their associated data, therefore they are always analyzed with respect to their  whole portrait. Subjects with specific conditions can be analyzed in isolation, or attempts can be made to generalize the properties of a peculiar subject. Back and forth analysis of the data are supported by BRAVIZ with iterations to isolate a case or to generalize to the group .In fact, samples of participants or data in BRAVIZ are recognized as an essential component of the analysis. They can be created in several ways, saved into the database for future use or used instantaneously in statistical models or group data visualizations. Researchers can thus iterate through several samples, several models, several measurements and several views, thus gaining understanding of the data-set and raising questions and hypotheses for future projects.

A log of each analysis session is automatically kept and made available through a web interface with all actions performed with the different applications used. Researchers can enhance this log by labeling the most important steps they made during a session and providing annotations. The status of an application can be reloaded at any point with a simple click of a button so that researchers are able to revisit visualization and explore different analysis paths, thus making possible to build on top of what was found with previous sessions.

In contrast to current tools, BRAVIZ enables the visualization of data from different participants and the between-participant comparisons with most associated technical issues hidden to the user. The traditional separation of workspace, with one window for medical image viewer, and a second for a spreadsheet of clinical data, the researchers manually (and repeatedly) search for correlations between both kinds of data. BRAVIZ fixed this issue of storage of individual files to manage in different softwares (access, format and transform data are automated and hidden actions) and harnesses and proceeds data in the same workspace. It follows that users focus on the task at hand, and not on technical details.

\section{Conclusions and Future Work}


BRAVIZ is a tool that facilitates interactive data visualization and exploratory analysis of datasets that combine clinical and neuro-image data. It is implemented as a set of applications that can be used at different points of exploratory analysis, possibly by different members of an interdisciplinary research team. Some applications are designed to extract scalar measurements from image data, others provide detailed views of particular subjects or data types and others perform group analyses. Custom samples of subjects can be defined and used across all applications to focus on the analysis. When several applications are running together, all of them can keep focus on the same subject (\ref{fig_imagine}) which supports and guide the users in their understanding of how the multi-dimensional views of the same individual's data interact together.

The architecture also streamlines implementation of additional applications by encapsulating all low level data manipulation in a library. For example, BRAVIZ could easily be extended to support group based analysis like second level fMRI or VBM (Voxel Based Morphometry). In addition, several researchers have expressed interest in integrating other kinds of data, for example EEG signals or connection graphs \cite{rubinov_complex_2010} derived from DWI or fMRI.  BRAVIZ is distributed under a LGPL license and the source code is available through the project web page \url{http://diego0020.github.io/braviz}. Additional testing with various datasets and by researchers of multiple backgrounds is required. Any assistance will be provided to any one interested in setting up the environment and using it. 

Braviz has been tested on a larger project from the Kangaroo Foundation which includes about 450 participants, complex event related fMRI paradigms, larger numbers of clinical variables, and more anatomical imaging modalities. A common concern is wether this approach will work with larger datasets, with thousands or even millions of participants. Data visualization can surprise us, but generally does not scale well; while data modeling typically does scale but cannot surprise us \cite{grolemund_r_2016}. Therefore, one must iterate between visualization and modeling. One approach is to start exploring with a smaller subsample, and when an interesting trend is found, to try to see if generalization works for the full sample. Likewise, visualizations on a smaller subsample can be used to further understand and explore results obtained elsewhere. To this end, BRAVIZ provides the subsample mechanism.


Currently there is a trend towards moving data storage and processing to dedicated servers and providing access to users via web browsers. This allows researchers to work from any place, or even start a session in one place and finish somewhere else. Logs, variables, samples and other analysis artifacts could be kept in a centralized location to ease data downloading from a single place. In addition, if multiple experts used the same back-end, sharing would become trivial. The back-end could be implemented via a set of dedicated servers, or it could run in a scalable cloud. Powerful data processing algorithms could also be provided to leverage high performance computing infrastructure. BRAVIZ ought to be accessible through a web interface in the future, given the potential generalization of its applicability.
  
The evergrowing interest in collecting data openly and making it available to the general community makes visual exploratory analysis tools like BRAVIZ become increasingly important. BRAVIZ has the ability to rapidly iterate and improve  thus its future versions could contribute to increase the scientific productivity, optimally use the collected data, integrate the analysis between different variables and different users, and eventually speed-up knowledge transfer. The case studies suggested that BRAVIZ could represent a clinically relevant tool to understand brain function but also in the future to assess and help in decision making for care and therapy over lifespan.
  
  
\section*{Acknowledgments}

This work was made possible by the Kangaroo Foundation, that generously provided a rich dataset, and whose experts were always willing to test prototypes and provide valuable feedback. The project also received important support from Colciencias, Universidad de los Andes, Iowa State University and Université Laval-CHU of Québec.

\bibliographystyle{frontiersinHLTH&FPHY}
\bibliography{zotero}

\section*{Figures}

\begin{figure}[p]
\begin{center}
\includegraphics[width=0.6\linewidth]{arquitecture.pdf}
\end{center}
 \caption{\label{fig_arch} The BRAVIZ software architecture, the main library is shaded}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=0.4\textwidth]{braviz_menu}
\end{center}
 \caption{\label{fig_menu} BRAVIZ main menu, each button provides access to an application }
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{subj_overview_full}
\end{center}
 \caption{\label{fig_subject}Main interface of the subject overview application: At the bottom of the render some variables about the subject provide context}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{quality_control_trim}
\end{center}
 \caption{\label{fig_sample} Quality control on the corpus callosum fibers from the whole sample}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{anova.png}
\end{center}
 \caption{\label{fig_anova}An application for performing ANOVA analyses using the data in the BRAVIZ database.}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{initial_corr}
\end{center}
 \caption{\label{fig_lm}A correlation with a prominent outlier}
\end{figure}


\begin{figure}
\begin{center}
\begin{subfigure}[b]{0.48\linewidth}
\includegraphics[width=\textwidth]{check_reg}
\caption{\label{fig_check_reg}Check Registration}
\end{subfigure}\hfill
\begin{subfigure}[b]{0.48\linewidth}
\includegraphics[width=\textwidth]{correlations}
\caption{\label{fig_correlations}Correlations}
\end{subfigure}

\begin{subfigure}[b]{0.48\linewidth}
\includegraphics[width=\textwidth]{roi_builder}
\caption{ROI Builder\label{fig_roi}}
\end{subfigure}\hfill
\begin{subfigure}[b]{0.48\linewidth}
\includegraphics[width=\textwidth]{fmri}
\caption{FMRI Explorer\label{fig_fmri}}
\end{subfigure}
\end{center}
 \caption{\label{fig_other_apps} Examples of BRAVIZ Applications}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{imagine.jpg}
\end{center}
 \caption{\label{fig_imagine} An example of BRAVIZ running on a large display in a collaborative setting.}
\end{figure}


\begin{figure}
	\centering
		\includegraphics[width=\linewidth]{cyril_plot}
	\caption{Correlation between length of callosal fibers and ITT in the PT and term groups}
	\label{fig_cyril_1}
\end{figure}

\begin{figure}
	\centering
		\includegraphics[width=\linewidth]{cc_cyril}
	\caption{Corpus Callosum from the circled outlier in Figure \ref{fig_cyril_1}}
	\label{fig_cyril_2}
\end{figure}


\begin{figure}
	\centering
		\includegraphics[width=0.9\linewidth]{cyricl_corr_1}
	\caption{VMI vs M1 excitability excluding outliers (empty circles)}
	\label{fig_cyril_4}
\end{figure}

\begin{figure}
	\centering
		\includegraphics[width=0.9\linewidth]{corr_cyril_2}
	\caption{VMI vs ipsilateral corticospinal responses excluding outliers (empty circles)}
	\label{fig_cyril_5}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=\linewidth,trim = 30mm 90mm 60mm 10mm ,clip]{parallel_coordinates_raw}
\end{center}
 \caption{\label{fig_parallel}Parallel coordinates display configured for searching possible PVL cases, lines that don't match the filters on each axis are shown in gray}
\end{figure}


\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{pvl_details}
\end{center}
 \caption{\label{fig_subject3}Details of a subject with possible PVL, the left panel shows values for several variables as well as the full clinical history.}
\end{figure}

\end{document}
