
\documentclass[utf8,paper]{frontiersSCNS} % for Science, Engineering and Humanities and Social Sciences articles
\usepackage[utf8]{inputenc}
%\usepackage{inputenc}
\usepackage[english]{babel}
%\DeclareUnicodeCharacter{2264}{$\leq$}
%\DeclareUnicodeCharacter{002E}{$\leq$}
\usepackage{letltxmacro}

\usepackage{stringenc}
\usepackage{pdfescape}

\makeatletter
%\renewcommand*{\UTFviii@defined}[1]{%
%  \ifx#1\relax
%    \begingroup
%      % Remove prefix "\u8:"
%      \def\x##1:{}%
%      % Extract Unicode char from command name
%      % (utf8.def does not support surrogates)
%      \edef\x{\expandafter\x\string#1}%
%      \StringEncodingConvert\x\x{utf8}{utf16be}% convert to UTF-16BE
%      % Hexadecimal representation
%      \EdefEscapeHex\x\x
%      % Enhanced error message
%      \PackageError{inputenc}{Unicode\space char\space \string#1\space
%                              (U+\x)\MessageBreak
%                              not\space set\space up\space
%                              for\space use\space with\space LaTeX}\@eha
%    \endgroup
%  \else\expandafter
%    #1%
%  \fi
%}
\makeatother

\LetLtxMacro{\ORIGselectlanguage}{\selectlanguage}
\makeatletter
\DeclareRobustCommand{\selectlanguage}[1]{%
  \@ifundefined{alias@\string#1}
    {\ORIGselectlanguage{#1}}
    {\begingroup\edef\x{\endgroup
       \noexpand\ORIGselectlanguage{\@nameuse{alias@#1}}}\x}%
}
\newcommand{\definelanguagealias}[2]{%
  \@namedef{alias@#1}{#2}%
}
\makeatother

\definelanguagealias{eng}{english}
\definelanguagealias{en}{english}

\makeatletter
\let\l@eng\l@english
\makeatother

%\setcitestyle{square}
\usepackage{url,hyperref,lineno,microtype}
\usepackage[onehalfspacing]{setspace}
%\linenumbers


% Leave a blank line between paragraphs instead of using \\


\def\keyFont{\fontsize{8}{11}\helveticabold }
\def\firstAuthorLast{Diego Angulo {et~al.}} %use et al only if is more than 1 author
\def\Authors{Diego Andres Angulo\,$^{1,*}$, Jose Tiberio Hernandez\,$^{1}$ , James Oliver$^{2}$ and Cyril Schneider\,$^{3}$}
% Affiliations should be keyed to the author's name with superscript numbers and be listed as follows: Laboratory, Institute, Department, Organization, City, State abbreviation (USA, Canada, Australia), and Country (without detailed address information such as city zip codes or street names).
% If one of the authors has a change of address, list the new address below the correspondence details using a superscript symbol and use the same symbol to indicate the author in the author list.
\def\Address{$^{1}$ IMAGINE, Universidad de los Andes, Bogotá , Colombia \\
$^{2}$VRAC, Iowa State University, Ames , IA, Unites States
\\
$^{3}$CNS, CHUL, Quebec , QC, Canada  }
% The Corresponding Author should be marked with an asterisk
% Provide the exact contact address (this time including street name and city zip code) and email of the corresponding author
\def\corrAuthor{Diego A. Angulo}
\def\corrAddress{IMAGINE, Universidad de los Andes, Carrera 1 \# 18A -12 , Bogotá, Colombia}
\def\corrEmail{da.angulo39@uniandes.edu.co}

\begin{document}
\onecolumn
\firstpage{1}

\title[Braviz]{Braviz: Visual Exploratory Analysis of Brain Datasets} 

\author[\firstAuthorLast ]{\Authors} %This field will be automatically populated
\address{} %This field will be automatically populated
\correspondance{} %This field will be automatically populated

\extraAuth{}% If there are more than 1 corresponding author, comment this line and uncomment the next one.
%\extraAuth{corresponding Author2 \\ Laboratory X2, Institute X2, Department X2, Organization X2, Street X2, City X2 , State XX2 (only USA, Canada and Australia), Zip Code2, X2 Country X2, email2@uni2.edu}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% The sections below are for reference only.
%%%
%%% For Original Research Articles, Clinical Trial Articles, and Technology Reports the section headings should be those appropriate for your field and the research itself. It is recommended to organize your manuscript in the
%%% following sections or their equivalents for your field:
%%% Abstract, Introduction, Material and Methods, Results, and Discussion.
%%% Please note that the Material and Methods section can be placed in any of the following ways: before Results, before Discussion or after Discussion.
%%%
%%%For information about Clinical Trial Registration, please go to http://www.frontiersin.org/about/AuthorGuidelines#ClinicalTrialRegistration
%%%
%%% For Clinical Case Studies the following sections are mandatory: Abstract, Introduction, Background, Discussion, and Concluding Remarks.
%%%
%%% For all other article types there are no mandatory sections.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstract}

%%% Leave the Abstract empty if your article falls under any of the following categories: Editorial Book Review, Commentary, Field Grand Challenge, Opinion or specialty Grand Challenge.
\section{}
Brain research typically requires large amounts of data from different sources and often, of different nature. The use of different softwares and tools adapted to the nature of each data makes the researchers’ work cumbersome and time consuming. It follows that data is not used to its fullest potential thus limiting exploratory analysis. This paper presents an ancillary software tool called BRAVIZ that integrates interactive visualization with real-time statistical analyses thus giving access to multi-facetted neuroscience data and automating many cumbersome and error-prone tasks required to explore such data. BRAVIZ does not rely on abstract numerical indicators and rather emphasizes a brain image as the main object of the analysis process of individuals or groups data. Altogether, BRAVIZ’s options facilitate exploration of trends or relationships to gain an integrated view of the phenomena studied thus motivating discovery of new hypotheses. A case study is presented that incorporates brain structure and function outcomes together with different types of clinical data.



\tiny
 \keyFont{ \section{Keywords:} Exploratory Analysis, Visual Analytics, Brain Data, MRI, Tractography, Cohorts } %All article types: you may provide up to 8 keywords; at least 5 are mandatory.
\end{abstract}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%From Cyril
% The 3 sections that precedes are not clear for me and should be re-written following my suggestions in order for the text to be stronger – there is no line of thoughts (at least for me, it’s very difficult to follow the ideas with all back and forth passages – especially, some passages are not correctly located (I mean, not in the right section). I may propose to point out the requirement of exploratory analysis and what is missing currently in literature and to state that Braviz will respond to these needs by cumulating the advantages of other techniques / softwares but avoiding the disadvantages (for example by creating an interface for the different tools interplay) – this provides the transition for presenting the tools. Be careful, this presentation is not for free and shall respond to a need.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Intro
% Requirements for exploratory analysis

% Related Work
% What is missing currently in literature

% Presentation, all justified on objectives, nothing is free
% Braviz... accumulates advantages and avoids disadvantages


\section{Introduction}


An important challenge in brain research, in both normal and pathological conditions, is to better understand the extent to which the physical structure of brain underlies the way it functions. The most common research procedure is characterized by experiments aimed at collecting data directed towards testing a former hypothesis. This confirmatory-like methodology imposes limitations on the way data is used, and it is typically used only once which is unfortunate since data acquisition is generally time and resource intensive.

In the two last decades brain research data has increasingly been gathered in a more open fashion and many databases are now available to the public \citep{milham_open_2012}. In parallel, technical and policy levels of data collection, storage and share were rapidly enhanced \citep{eckersley_neuroscience_2003}, together with technologies to consolidate, search and access the data \citep{van_horn_is_2009, wood_harnessing_2014}. 
This allows massive amounts of data to be consolidated into databases and searched in efficient ways.  In this way questions can be explored and large data pools can be mined for interesting relationships. This led to rapid changes in the way research can be conducted, i.e., a shift from hypothesis-driven research into data-driven research, where data is available first and research questions and hypotheses are formulated on the basis of the exploration of data.The methodology used in data driven research differs significantly from the one in hypothesis driven research. Data driven research seeks to find and extract meaningful insights from data using exploratory research \citep{tukey_we_1980} and has already proven efficiency in economics, terrorism prevention and business intelligence domains with large and heterogeneous data sets \cite{cook_illuminating_2005}. Exploratory research involves iterating through data several times, looking at it from different points of view, transforming data, searching for interesting subjects and measures, gathering details and performing group analyzes. These analysis tasks are carried out multiple times in different order as researchers learn more about the data. It is therefore convenient to provide facilities to make annotations and save findings, so that exploration can be continued later.

During this process several data patterns may likely lead to unexpected insights. Unfortunately, it is also likely that these patterns are caused by the unique noise structure of the current data and therefore cannot be generalized to the global population. Automatic data-mining algorithms can find thousands of possible relations , but true findings need to be backed up by science and current knowledge.  Therefore, domain experts must be involved in interpretation of insights. Moreover, insights that integrate data from different domains require experts from all these domains.

Visual analytics \citep{keim_visual_2008} has emerged as a discipline which attempts to integrate statistics, machine learning, data mining and interactive data visualization with the objective of optimizing the use of data available for exploratory research. The analyst is acknowledged as the most important actor, and all tools are designed to support exploration and provide timely access to the required data and to informatics and statistics functions . Another principle in visual analytics is that analysts should keep focus on data and not on operational details of the tools. Therefore tools should provide the data and functionality to complete the task; while not relevant details and complex functionality should remain hidden. 
					
Exploratory brain research  could also benefit from visual analytics techniques. Indeed, brain function-related datasets are a combination of spatial (brain imaging) and non-spatial (clinical) outcomes that could be analyzed altogether to better understand the link between brain structure and function and human behavior. . Spatial outcomes interest for example brain anatomy acquired by means of magnetic resonance imaging (MRI), neural pathways trajectory acquired by diffusion weighted imaging(DWI) or patterns of cerebral activation in specific tasks and acquired by functional MRI (fMRI). Specialized tools implemented in visual analytics of brain could process imaging and model brain structure, build pathways, also produce statistical maps of activation patterns and neural connectome, all these measures being then correlated to other data of different nature such as neuropsychological.

However, the tools currently used in research are generally specific to the type or domain of data analyzed and they are optimized to support linear work flows. It follows that experts switch between tools to integrate and analyze data from different domains. In the worst cases, they move to a different computer. This process is time-consuming, repetitive, with attention focused on the ``how'' instead on the ``what'' thus making exploratory analysis challenging.

The current paper introduces BRAVIZ, a software tool based on visual analytics and aimed at supporting exploratory analysis in brain research. More specifically, the tool focused on datasets that include MRI derived outcomes and clinical outcomes. BRAVIZ tool is composed of several applications, such as for example interactive visualizations, links to detailed meta-data, creation of new variables and statistical models are designed to support and facilitate full exploratory analyses.  

\section{RELATED WORK ON NEUROIMAGING AND EXPLORATORY ANALYSIS }


Several tools can already be used by visual analytics applications to support research on neuroimaging. For example, Freesurfer \citep{fischl_freesurfer_2012}, FSL \citep{jenkinson_fsl_2012} and SPM \citep{friston_statistical_2006} segment, register and perform statistical testing of brain image data. \citep{fedorov_3d_2012}, Brain Visa \citep{cointepas_brainvisa:_2001} and ITKSnap \citep{yushkevich_user-guided_2006} are commonly used to integrate data from different image modalities (structural, diffusion-weighted, functional among others). They all proved to be efficient at processing bulk images in a pipeline, and visualizing data from a single subject, but they fall short when several iterations through the data are required. The interfaces proposed for statistical testing require extensive configuration, which is appropriate for testing specific hypotheses, but becomes cumbersome when several possibilities are to be explored. Efficient mechanisms for restricting analysis to a set of subjects after the analysis or going back to individuals’ details are missing. Complementary data loaded from tables can be used, but changing variables often means creating new tables and making them fit the requested format.


Non-spatial information visualization tools like \citep{cook_interactive_2007}, and Tableau\citep{hanrahan_tableau_2003} can be used for interactive exploratory analysis. They support data transformations, model fitting, and interactive visualization. They also enable the detection of outliers (important in data-driven research whereas usually removed from hypothesis-driven research), get additional details, determine subgroups, and visualize in different ways (parallel coordinates, scatter plots, histograms, etc ) patterns and trends. However these tools do not integrate well with spatial data. Scalar data derived from original images can be added but there is no easy way to link back to original data or to explore spatial features that cannot be encoded into numerical variables.


INVIZIAN \citep{bowman_query-based_2011,bowman_feature-similarity_2012,bowman_visual_2012} uses ggobi options to explore in an abstract 3D space the relations between scalar values and anatomical features of large brain datasets. It provides an environment for exploratory research involving data from several databases targeted to hypotheses generation. However, it only works with automatic feature extraction from structural MRI. As BRAVIZ, INVIZIAN focuses on easing the user’s visual pattern search, but BRAVIZ targets projects including the analysis of different modalities of data from structural to functional MRI for example, and focuses on data generated by users rather than on machine learning. 


A visual analysis tool for high dimensional genetic and clinical data is presented in \citep{hinterberg_peax:_2014}. The user explores the data by quickly iterating through several models that relate genetic data to clinical outcomes. Models are displayed as trees land linked with distributions of the selected parameters. Tools are provided to automatically searching for the most relevant parameters and therefore reducing the search space. This tool is optimized for a single type of data, a single type of model and a specific workflow. In contrast, BRAVIZ seeks to support multiple tasks, data types and workflows by providing a set of  applications to be used independently or combined for complex exploratory analyzes.
	
Even though multiple tools  exist for analysis and exploration of spatial and non-spatial data, the integration of multiple kinds/levels of analyzes and data in a single environment remains challenging. BRAVIZ provides a unique unified environment for analyzing spatial and non-spatial data interactively, and in this way, it supports data-driven research.

\section{The BRAVIZ Proposal}

Instead of a single large monolithic application, this research takes a more distributed approach and thus BRAVIZ is comprised of a set of applications tailored towards specific analysis tasks and data types, each of which integrates with a single common database and consistent user interface elements (see Figure \ref{fig_arch}). BRAVIZ provides facilities for loading spatial data (and transforming it into an appropriate coordinate system), for manipulating tabular data, for creating spatial and non-spatial interactive data visualizations, and for interacting with other applications and users. The types spatial-data supported by the current implementation are: structural MRI, diffusion MRI, functional MRI, label maps, tractography reconstructions, structure segmentation models and FreeSurfer cortex reconstructions. Non-spatial data can be any numeric or categorical variable, this includes clinical data, socio-economic data and results from neuro-psychological tests.

The BRAVIZ applications focus on providing the appropriate visualizations and interactions for specific analysis problems. All applications share the same base library, and therefore can benefit from several common operations. New applications can also be implemented based on this library, freeing developers from thinking about technical details related to handling spatial-data. Another benefit is that all applications share the same data repository, which provides a channel for data sharing. Users can create custom samples, new variables and custom geometric structures and store them in the database, where they can be read by any other BRAVIZ application. An additional communication mechanism is provided that enables applications exchange data in real-time. In this way individual applications can be combined to solve more complex tasks.


\subsection{Design and Development Methodology}

A ``user centered'' approach\citep{fernandez_user-centered_2013,wassink_applying_2009} was used in the design and implementation of BRAVIZ. The authors worked closely with brain researchers of several specialties, visited several labs and hospitals, and learned as much as possible about research workflows and the bottlenecks they contain. In several iterations, prototypes were implemented and shared them with domain experts, whose feedback motivated the design of the next generation. 

The initial stages of design focused on identifying the obstacles that affect exploratory analysis and communication between experts, and explored ways of mitigating them. The team of experts was composed of radiologists, psychiatrists, pediatricians, physicians, physiologists, neonatologists,  statisticians, engineers and economists. 

From analyzing the visualization capabilities in current neuro-image tools, as well as how experts use them, the BRAVIZ team learned what was expected from image viewers, which features were important and which ones were seldom used. Tools like SPM \citep{friston_statistical_2007}, Osirix \citep{rosset_osirix:_2004} and 3D-Slicer \citep{fedorov_3d_2012} were the reference at this stage. For example, it is very important for researchers to visualize several types of data in the same space, and to be able to compare two images. It was also evident that there is a need to integrate spatial visualizations with non-spatial data about the same subject. Another common need discovered in this process is for navigating across subjects in the study, without having to create the visualization from zero for each subject. This could be accomplished using custom scripts as most applications include command line interfaces, but this is cumbersome, and target users prefer graphical user interfaces.

\subsection{Applications Set}

%Not sure if this needs a different section, maybe it should be summarized into the description

The current set of applications comprising BRAVIZ can be divided in three categories. One set of applications focuses on measuring or creating new descriptors from geometric data, another focuses on displaying geometric data using other variables as context, and the last one focuses on exploring numerical and categorical data. These support different stages of the exploratory analysis process, respectively, data transformation, visualization and performing group analyzes. Additionally there are utilities for importing and exporting data in spreadsheet format; which enables interaction with third party applications. All tools are accessible from the graphical menu shown in \ref{fig_menu}. 

The ROI (region of interest) Builder application provides an interface for helping experts position spherical regions of interest in a 3D space. Images of all modalities and cortex reconstructions can be used as context. It is also possible to preview the fibers that cross the ROI and the mean value inside the sphere of FA, MD or the fMRI statistical map. An algorithm to interpolate the position and size of ROIs on other subjects, by using the available registration maps, is also available. In this way researchers only need to make corrections and can rapidly define ROIs for a selected sample. The fiber bundles defined here, and the associated scalars can then be used in the rest of the system.

The Subject Overview application is shown on Figure \ref{fig_subject}. This tool provides access to several kinds of spatial-data in an integrated space, and permits rapid navigation through the subjects in the sample. Some geometrical features, such as volume or mean FA inside a structure, can be captured directly from  this application and added into the database as a new variable. The application also shows the values for selected variables for the current subject as well as textual annotations. In this way a full overview of the subject can be obtained.

A small-multiples view \citep{tufte_visual_1983} display of several subjects (see Figure  \ref{fig_sample}), is also available in the Sample Overview application. This application is useful for finding trends across a sample or for quality control to identify problematic images. Subjects are arranged from left to right according to a numerical variable, and rows are defined by a nominal variable. In the example shown, the two rows are males and females, and the ordering variable is the score on a math test. The bar-plot at the right shows the distribution of the variable among the two groups and is linked with the 3D views. If a more detailed view of any subject is required, the user may right click on it and from the context menu open a Subject Overview application with the corresponding subject and visualization. 

The purpose of the ANOVA application (see Figure\ref{fig_anova}) is fitting ANOVA models using the variables in the database.  The main plot shows diagnostics, i.e. distribution of residuals and a scatter plot of residuals vs fitted values, and the table at the bottom right shows the resulting fitted values. The application can also show box-plots and scatter-plots which relate the outcome to the regressors. Individual points from these plots can be right clicked, and loaded in a Subject Overview application in order to inquire for additional details.

Figure \ref{fig_other_apps} shows other applications currently built into the system. For additional information about how the system is implemented and the full list of applications please refer to the additional material.

\section{Case Studies}

In this research, a particularly representative case study, the kmc project \citep{schneider_cerebral_2012}, is introduced to both motivate the requirements for BRAVIZ and demonstrate its effectiveness. The kmc study explores the effect of treatment options on premature births and data on subjects was collected from several fronts. The original randomized study involving about 750 preterm babies was conducted in 1994 \citep{charpak_kangaroo_1997}. These children were followed during their first year \citep{charpak_randomized_2001, tessier_kangaroo_2009} of life and several clinical and socio-economical variables were registered. Forty of the children from the original study were re-located at fifteen years of age, and the subjects went through several neuropsychological tests, measuring attention, memory, reasoning skills and hand-eye coordination among others. They also went to vision, hearing and full medical examinations.Finally, they were scanned with Structural MRI, DTI and several fMRI paradigms. These images were processed using freesurfer \citep{fischl_freesurfer_2012}, fsl\citep{jenkinson_fsl_2012}, camino\citep{cook_camino:_2006}, and spm\citep{friston_statistical_2006}; which extracted several numerical measurements and geometric structures as segmentations and tractographies. All of this data was collected for testing specific hypotheses but the specialists involved in the study are also interested in analyzing it for unexpected relationships and trends; in other words, to perform an exploratory analysis.


\section{Discussion}
\label{sec:disc}
%Several users who have contributed to the development of BRAVIZ now use it regularly as part of their work. They continue experimenting with the tool and proposing improvements. Many users, especially those without expertise in image processing, like how they now can create and analyze spatial data on their own.  By using BRAVIZ it is straightforward to explore the data and answer questions. It is also common for more complex ideas to occur to the user while exploring. While exploring in this fashion, experts often discover new ways to use the processing power of tools like Freesurfer or SPM; and therefore take better advantage of them.
%
%Even without looking at spatial data, users enjoy getting visualizations of nominal and numerical variables instantaneously, which allows them to explore the dataset efficiently. BRAVIZ tools have proven to be easy to learn. It is designed to provide a starting point for facilitating exploratory analysis, and we expect that afterward users may move to more powerful and complex tools.
%
%The features that BRAVIZ users appreciated the most were quick identification of outliers and being able to find nominal and numerical data together with the corresponding image data. An unexpected result was that by exploring the data with BRAVIZ several data problems were discovered and many of them could be fixed by going back to the raw data or processing again. 
%
%The examples shown here used a rather small database, but BRAVIZ has been used successfully in a similar study with around 400 subjects. At this scale most of the visualizations still work, but for larger datasets new approaches must be developed. 
%
%Some researchers are used to working only in confirmatory analyses, and are very cautious about exploring data freely. Sometimes they fear that exploration might invalidate any chance of publishing results. However as long as care is taken on interpreting the results of exploration and hypotheses are tested on independent datasets there is no danger in doing exploratory analyses. It is well known that the amount of data available for analysis today is enormous, but better tools are needed to navigate and explore it. There is also an opportunity to change workflows to adjust to this new reality and take the best advantage of the available data. Data mining tools and visual exploration of data has been successfully applied in several other areas, such as business and law enforcement, and will continue to gain popularity in brain research. 
%
%Collaboration between experts is improved by having visualizations available to explain ideas. By having several applications open, large display real-estate can be leveraged (see Figure \ref{fig_imagine}). This works best when several experts are looking from different perspectives, and in this way unexpected elements and multidimensional trends can be spotted.
%
%%Future work
%%Web based?
%
%In its current state BRAVIZ runs on the user's machine, and the installation process is not trivial. In the future it should transform into a webservice, running no a cloud environment, and available through a standard web-browser. However, the technology for displaying interactive 3D images on a web environment is not mature enough. Nevertheless, technologies as Brainbrowser\citep{sherif_brainbrowser:_2014}, and paraview\citep{ahrens_36_2005} are advancing fast, and probably in the near future it will be able to migrate to such a platform. 

% Though the system is built from several small applications, they are designed to work together synchronously in order to support more complex tasks. Subsamples, variables and subjects of interest can be shared across tools and among colleagues. Altogether, this creates a flexible environment that can be adapted to several kinds of data, questions, workflows and experts. These features, combined with having all data and analysis tools a couple of clicks away; provides a pleasant and efficient exploratory analysis environment. 


%\bibliographystyle{frontiersinSCNS_ENG_HUMS} % for Science, Engineering and Humanities and Social Sciences articles, for Humanities and Social Sciences articles please include page numbers in the in-text citations
\bibliographystyle{frontiersinHLTH&FPHY} % for Health and Physics articles
\bibliography{zotero}

%%% Upload the *bib file along with the *tex file and PDF on submission if the bibliography is not in the main *tex file

\section*{Implementation (Appendix)}

BRAVIZ is implemented in Python, a popular language in the neuroscience community \citep{gorgolewski_nipype:_2011, garyfallidis_dipy_2014}, which provides powerful plotting, rendering, and data manipulation libraries. The trade-off is a loss of performance compared to compiled languages, but so far interactivity has been maintained by letting VTK\citep{schroeder_vtk_1998} and Numpy\citep{van_der_walt_numpy_2011} do the most intensive operations. It has been tested in Mac, Windows and Linux.


The ``Read and Filter'' module handles all access to the file system or network. Each BRAVIZ project is composed of a SQLite database, and spatial data. This module provides other useful functions like attaching scalars to geometric objects, filtering fiber bundles and transforming between coordinate systems. Underneath it relies heavily on nibabel\citep{gorgolewski_nipype:_2011}, numpy\citep{van_der_walt_numpy_2011} , scipy\citep{jones_scipy:_2001,oliphant_python_2007} and VTK\citep{schroeder_vtk_1998} . Notice that this module handles all the necessary transformations of spatial data, and exposes a high level interface to the upper layers. In this way application designers can focus on visualization and interaction as required by end users and let the library handle registration and other low level operations. The module also provides access to numerical and categorical variables that are stored in a database. Pandas' DataFrames\citep{mckinney_data_2010} are the preferred way to manipulate this data. The database also holds annotations, scenarios, user defined geometrical objects and analysis history. 

Specific project reader modules can be created to adjust to the layout, file names and other peculiarities of each research project. The active project, favorite variables and favorite subject and other preferences are specified through a configuration file.
By accessing data through this module, developers can create applications that can be reused in several projects. 

The ``visualization'' module provides reusable components for visualizing spatial and non-spatial data. VTK is used for all the 3D visualization while 2D visualization is achieved through matplotlib \citep{hunter_matplotlib:_2007} and seaborn\citep{michael_waskom_seaborn:_2014} in native applications, or through D3 \citep{bostock_d3_2011} in web applications.

The ``interaction'' module contains, among others, several reusable user interface components, functions for doing statistical calculations in R\citep{team_r:_2012, gautier_rpy2:_2008} and additional processing for geometric data, and connection mechanisms between applications. The current version uses PyQt4 for the user interface with some web based visualizations built using the tornado framework \citep{server_source_2008}. 

Individual applications use a different mixture of the provided modules depending on user requirements. Most of the code inside each application should be about user interaction and coordination between visualizations. If new data processing algorithms or visualizations are required they should be implemented as reusable components in the library so that future applications can benefit from them. The project is licensed under a lesser general public license (LGPL) and its source code is available at \url{https://bitbucket.org/dieg0020/braviz}, together with installation instructions. Additional documentation is available at \url{http://diego0020.github.io/braviz}.

\section*{Acknowledgments}

\section*{Figures}

%%% Use this if adding the figures directly in the mansucript, if so, please remember to also upload the files when submitting your article
%%% There is no need for adding the file termination, as long as you indicate where the file is saved. In the examples below the files (logo1.jpg and logo2.eps) are in the Frontiers LaTeX folder
%%% If using *.tif files convert them to .jpg or .png
\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.4\textwidth]{figures/braviz_menu.PNG}
\end{center}
 \textbf{\refstepcounter{figure}\label{fig_menu} Figure \arabic{figure}.}{This menu is currently used to access the different applications. It also provides facilities to review the available variables and the saved scenarios, to view and create subsamples, and to import to and export from spreadsheets.  }
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/subj_overview_full.PNG}
\end{center}
 \textbf{\refstepcounter{figure}\label{fig_subject} Figure \arabic{figure}.}{Main interface of the subject overview application. At the bottom of the render panel some variables about the subject are shown to provide context. At the bottom-left corner we have controls to change the coordinate system, and to move the camera to preset positions. Most of the data is available via the different tabs at the left panel. The current tab provides a list of available subjects, it is enough to double click in a row to get the selected data for that subject. The arrows directly under the 3D viewer provide another convenient way to move through the subjects following the order of the list. }
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/sample_overview.PNG}
\end{center}
 \textbf{\refstepcounter{figure}\label{fig_sample} Figure \arabic{figure}.}{This application gives access to the data of several subjects at the same time. Images are sorted from left to right according to a numerical variable (shown in the bars at the right) and arranged in columns by a cathegorical variable (bars color)  }
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/anova.PNG}
\end{center}
 \textbf{\refstepcounter{figure}\label{fig_anova} Figure \arabic{figure}.}{An application for performing ANOVA analyses using the data in the BRAVIZ database. You can right click on an outlier to select it on all open BRAVIZ applications. }
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/many_apps.png}
\end{center}
 \textbf{\refstepcounter{figure}\label{fig_other_apps} Figure \arabic{figure}.}{Examples of currently available applications. A) ROI builder. B) Linear model. C) Explore fMRI. D) Correlations. E) Parallel coordinates}
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.4\textwidth]{figures/arquitecture.png}
\end{center}
 \textbf{\refstepcounter{figure}\label{fig_arch} Figure \arabic{figure}.}{The BRAVIZ software architecture. At the bottom there are specialized reader classes for each data-set which handles low level access to the specific projects' data. In gray is the main  library, which provides modules for visualization, interaction and data manipulation. On top user applications are built. In order to adapt the system to a new data-set it is only necessary to adapt a project reader.}
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/imagine.jpg}
\end{center}
 \textbf{\refstepcounter{figure}\label{fig_imagine} Figure \arabic{figure}.}{An example of BRAVIZ running on a large display in a collaborative setting. All of the applications are linked, this means that selecting a subject in one application will highlight or select that subject on all of them.}
\end{figure}




\end{document}
